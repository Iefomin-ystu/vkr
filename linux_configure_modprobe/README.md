linux_configure_modprobe
=========

## Ограничения

- Пользователь должен самостоятельно решать нужно пересобирать dracut или нет
- Пересборка dracut не запустится, если не было изменений при добавлении модулей в черный список или отключении модулей в ядре
- После пересборки dracut рекомендуется перезагрузка сервера для корректного применения изменений

## Autodoc

<p style="text-align: center;">Блок документации сформирован автоматически</p>

---

### Описание

linux_configure_modprobe - Настройка modprobe.

### Требования

- Минимальная версия ansible: 2.15
- Коллекции:
- Роли:

### Поддерживаемые платформы

Поддерживаемые операционные системы с версиями

- EL:
  - 9

### Переменные окружения

| Название         | Обязательный             | Описание         | Пример       |
| ------------------------ | ------------------------------------ | ------------------------ | ------------------ |

### Default'ные переменные

| Название                   | Тип    | Значение         | Описание                                                                                                              |
| ---------------------------------- | --------- | ------------------------ | ----------------------------------------------------------------------------------------------------------------------------- |
| modprobe_dracut_regenerate | bool   | false            | Стандартное значение признака н<br>необходимости пересборки dracut                                                    |

### Обязательные и необязательные параметры

| Название                        | Тип    | Обязательный             | Значение         | Описание                                                                                                                                                                                      |
| --------------------------------------- | --------- | ------------------------------------ | ------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| modprobe_blacklist_modules_list | list   | true                     | *                | Список модулей для отключения                                                                                                                                                                 |
| modprobe_dracut_regenerate      | bool   | false                    | true, false      | Признак необходимости пересборки initramfs. Указывается true, если удаляется модуль, являющийся частью initramfs.                                                                             |
| modprobe_server_reboot          | bool   | true                     | true, false      | Признак необходимости перезагрузки сервера ролью.                                                                                                                                             |

### Предопределённые переменные

| Название         | Тип    | Значение         | Описание         |
| ------------------------ | --------- | ------------------------ | ------------------------ |


### Возвращаемые параметры
| Название         | Описание         | Значение         |
| ------------------------ | ------------------------ | ------------------------ |


### Примеры использования

```yaml
hosts: all
name: Blacklist kernel modules
roles:
- role: tensor.linux.linux_configure_modprobe
  vars:
    modprobe_blacklist_modules_list:
    - cramfs
    - squashfs
    modprobe_dracut_regenerate: true
    modprobe_server_reboot: true
```


---
<p style="text-align: center;">Блок документации сформирован автоматически</p>
